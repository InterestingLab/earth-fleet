#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Note that the upper structure is only for the convenience of editors. Do not repeat operations on the bottom key.
grok_templates:
  # Universal template
  general:
    NOTSPACE: "[^\\s]+"
    SPACE: "\\s+"
    WORD: "\\b\\w+\\b"
    NUMBER: "(?:%{BASE10NUM})"
    BASE10NUM: "[+-]?(?:[0-9]+(?:\\.[0-9]+)?)"
    QUOTEDSTRING: "`(?:(?<!\\)(?:(?:\"(?:[^\"]|\\.)*\"))"

  # Time and date template
  time_date:
    YEAR: "\\b\\d{4}\\b"
    MONTHNUM: "(?:0?[1-9]|1[0-2])"
    MONTHDAY: "(?:0?[1-9]|[12][0-9]|3[01])"
    HOUR: "(?:2[0-3]|[01]?[0-9])"
    MINUTE: "[0-5]?[0-9]"
    SECOND: "(?:[0-5]?[0-9](?:[.,][0-9]+)?)"
    ISO8601_TIMEZONE: "(?:Z|[+-][0-9]{2}:[0-9]{2})"
    DATE: "%{YEAR}-%{MONTHNUM}-%{MONTHDAY}"

  # Network related templates
  network:
    IP: "(?:%{IPV4}|%{IPV6})"
    IPV4: "(?:\\d{1,3}\\.){3}\\d{1,3}"
    IPV6: "([a-fA-F0-9:]+:+)+[a-fA-F0-9]+"
    MAC: "(?:[0-9A-Fa-f]{2}[:-]){5}[0-9A-Fa-f]{2}"
    URI: "[A-Za-z][A-Za-z0-9+.-]*:(?:/{1,3}|[A-Za-z0-9%])[^ ]+"

  # File system related templates
  filesystem:
    PATH: "(?:/[A-Za-z0-9._-]+)+/?"
    FILENAME: "[A-Za-z0-9._-]+"
    EXT: "\\.[A-Za-z0-9]+"

  # Log level template
  log_level:
    LOGLEVEL: "\\b(?:TRACE|DEBUG|INFO|WARN|ERROR|FATAL)\\b"
