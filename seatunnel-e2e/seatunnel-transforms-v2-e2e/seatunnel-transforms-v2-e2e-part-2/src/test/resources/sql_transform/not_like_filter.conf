env {
  execution.parallelism = 1
  job.mode = "BATCH"
  checkpoint.interval = 10000
}

source {
  FakeSource {
    result_table_name = "fake"
    schema = {
      fields {
        id = "int"
        name = "string"
        age = "int"
        email = "string"
      }
    }
    rows = [
      {fields = [1, "Joy Ding", 20, null], kind = INSERT}
      {fields = [2, "May Ding", 22, "may_ding@apache.com"], kind = INSERT}
      {fields = [3, "Kin Dom", 21, "kin_dom@apache.com"], kind = INSERT}
    ]
  }
}

transform {
  Sql {
    source_table_name = "fake"
    result_table_name = "fake1"
    query = "select id,name,age from fake where  name not like '%Din_'"
  }
}

sink {
  Console {
    source_table_name = "fake1"
  }
  Assert {
    source_table_name = "fake1"
    rules = {
      field_rules = [
        {
          field_name = "name"
          field_type = "string"
          field_value = [
            {equals_to = "Kin Dom"}
          ]
        }
      ]
    }
  }


}